
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>How to choose parameters for TRIQS/cthyb &#8212; DCore 1.0.0 documentation</title>
    <link rel="stylesheet" href="../../_static/triqs.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/dcore.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Programs" href="../../reference/programs.html" />
    <link rel="prev" title="How to choose parameters for ALPS/cthyb" href="alps_cthyb.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
    <script src="../../_static/cufon-yui.js" type="text/javascript"></script>
    <script src="../../_static/spaceman.cufonfonts.js" type="text/javascript"></script>
    <script type="text/javascript">
      Cufon.replace('.triqs', { fontFamily: 'spaceman', hover: true }); 
    </script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>

  </head><body>
<div class="pageheader">
  <ul>
    
    <li><a href="../../install.html">Install</a></li>
    
    <li><a href="../../documentation.html">Documentation</a></li>
    
    <li><a href="../../presentation.html">Presentatation</a></li>
    
    <li><a href="../../issues.html">Issues</a></li>
    
    <li><a href="../../about.html">About DCore</a></li>
    
  </ul>
  <div>
    <h1 style="padding:0; margin: 10px 0 0 0;"><a class="triqs" href="../../index.html">DCore</a></h1>
    <span style="font-size: 14px; margin: 0px; padding: 0px;">integrated DMFT software for CORrelated Electrons</span>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../reference/programs.html" title="Programs"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="alps_cthyb.html" title="How to choose parameters for ALPS/cthyb"
             accesskey="P">previous</a> |</li>
    <li><a href="../../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../documentation.html" accesskey="U">Documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">How to choose parameters for TRIQS/cthyb</a><ul>
<li><a class="reference internal" href="#basic-parameters-for-qmc">Basic parameters for QMC</a></li>
<li><a class="reference internal" href="#high-frequency-tail-fit">High-frequency tail fit</a></li>
<li><a class="reference internal" href="#multi-band-system">Multi-band system</a></li>
<li><a class="reference internal" href="#pade-approximation-for-dos-and-spectrum-function">Pade approximation for DOS and spectrum function</a></li>
<li><a class="reference internal" href="#legendre-filter">Legendre filter</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="alps_cthyb.html"
                        title="previous chapter">How to choose parameters for ALPS/cthyb</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../../reference/programs.html"
                        title="next chapter">Programs</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/tutorial/cthyb/cthyb.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="how-to-choose-parameters-for-triqs-cthyb">
<span id="howtocthyb"></span><h1>How to choose parameters for TRIQS/cthyb<a class="headerlink" href="#how-to-choose-parameters-for-triqs-cthyb" title="Permalink to this headline">¶</a></h1>
<div class="section" id="basic-parameters-for-qmc">
<h2>Basic parameters for QMC<a class="headerlink" href="#basic-parameters-for-qmc" title="Permalink to this headline">¶</a></h2>
<p>The accuracy of the TRIQS/cthyb calculation depends on mainly the following
three parameters.</p>
<blockquote>
<div><ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">n_cycles{int}</span></code></p>
<p>The number of QMC cycles for computing any quantities.
The numerical noise can be reduced by increasing this parameter.</p>
<p>When we use the MPI parallelism, the total number of QMC cycle
( <code class="docutils literal notranslate"><span class="pre">number-of-processes</span> <span class="pre">*</span> <span class="pre">n_cycles</span></code>) affects the accuracy.
Therefore,
<strong>n_cycles in inverse proportion to the number of MPI processes keeps the accuracy</strong>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">n_warmup_cycles{int}</span></code></p>
<p>The number of QMC cycles for the thermalization before the above main calculation.
If it is insufficient, the state to be computed may be different from the
equilibrium state.</p>
<p><strong>This parameter is independent of the MPI parallelism.</strong></p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">length_cycle{int}</span></code></p>
<p>Each QMC cycles have sub-cycles.
The length of this sub-cycle should be long enough to escape from the auto-correlation.</p>
<p><strong>This parameter is independent of the MPI parallelism.</strong></p>
</li>
</ul>
</div></blockquote>
<p>The computational time is proportional to <code class="docutils literal notranslate"><span class="pre">length_cycle*(n_cycles+n_warmup_cycles)</span></code>.
The following script is an example to describe the procedure for searching appropriate QMC parameter.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

cat &gt; pre.ini <span class="s">&lt;&lt;EOF</span>
<span class="s">[model]</span>
<span class="s">seedname = bethe</span>
<span class="s">lattice = bethe</span>
<span class="s">norb = 1</span>
<span class="s">nelec = 1.0</span>
<span class="s">t = 1.0</span>
<span class="s">kanamori = [(4.0, 0.0, 0.0)]</span>

<span class="s">[system]</span>
<span class="s">beta = 40.0</span>
<span class="s">nk = 100</span>

<span class="s">[impurity_solver]</span>
<span class="s">name = TRIQS/cthyb</span>
<span class="s">n_warmup_cycles{int} = 10000</span>
<span class="s">n_cycles{int} = 10000</span>
<span class="s">length_cycle{int} = 100</span>

<span class="s">[control]</span>
<span class="s">max_step = 1</span>
<span class="s">EOF</span>

dcore_pre pre.ini

n_cycles<span class="o">[</span><span class="m">0</span><span class="o">]=</span><span class="m">3000</span><span class="p">;</span>   n_warmup_cycles<span class="o">[</span><span class="m">0</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">0</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">1</span><span class="o">]=</span><span class="m">10000</span><span class="p">;</span>  n_warmup_cycles<span class="o">[</span><span class="m">1</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">1</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">2</span><span class="o">]=</span><span class="m">30000</span><span class="p">;</span>  n_warmup_cycles<span class="o">[</span><span class="m">2</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">2</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">3</span><span class="o">]=</span><span class="m">100000</span><span class="p">;</span> n_warmup_cycles<span class="o">[</span><span class="m">3</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">3</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">4</span><span class="o">]=</span><span class="m">300000</span><span class="p">;</span> n_warmup_cycles<span class="o">[</span><span class="m">4</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">4</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">5</span><span class="o">]=</span><span class="m">300000</span><span class="p">;</span> n_warmup_cycles<span class="o">[</span><span class="m">5</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">5</span><span class="o">]=</span><span class="m">100</span>

<span class="k">for</span> i in <span class="sb">`</span>seq <span class="m">0</span> <span class="m">5</span><span class="sb">`</span>
<span class="k">do</span>
    sed -e <span class="s2">&quot;/n_cycles/c n_cycles{int} = </span><span class="si">${</span><span class="nv">n_cycles</span><span class="p">[i]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="se">\</span>
        -e <span class="s2">&quot;/n_wamup_cycles/c n_warmup_cycles{int} = </span><span class="si">${</span><span class="nv">n_wamup_cycles</span><span class="p">[i]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="se">\</span>
        -e <span class="s2">&quot;/length_cycle/c length_cycle{int} = </span><span class="si">${</span><span class="nv">length_cycle</span><span class="p">[i]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="se">\</span>
    pre.ini &gt; dmft.ini
    mpiexec -np <span class="m">4</span> dcore dmft.ini
    dcore_check dmft.ini --output bethe.pdf
    mv bethe_sigma.dat cyc<span class="si">${</span><span class="nv">n_cycles</span><span class="p">[i]</span><span class="si">}</span>_warm<span class="si">${</span><span class="nv">n_warmup_cycles</span><span class="p">[i]</span><span class="si">}</span>_len<span class="si">${</span><span class="nv">length_cycle</span><span class="p">[i]</span><span class="si">}</span>.dat
<span class="k">done</span>
</pre></div>
</div>
<p>Then, we use gnuplot as</p>
<div class="highlight-gnuplot notranslate"><div class="highlight"><pre><span></span>gnuplot&gt; plot [0:10][-0.6:0] \
&quot;cyc3000_warm5000_len50.dat&quot; u 1:3 w l lw 3, \
&quot;cyc10000_warm5000_len50.dat&quot; u 1:3 w l lw 3, \
&quot;cyc30000_warm5000_len50.dat&quot; u 1:3 w l lw 3, \
&quot;cyc100000_warm5000_len50.dat&quot; u 1:3 w l lw 3, \
&quot;cyc300000_warm5000_len50.dat&quot; u 1:3 w l lw 3, \
&quot;cyc300000_warm5000_len100.dat&quot; u 1:3 w l lw 3
</pre></div>
</div>
<p>and obtain</p>
<a class="reference internal image-reference" href="../../_images/QMCparam.png"><img alt="../../_images/QMCparam.png" class="align-center" src="../../_images/QMCparam.png" style="width: 500px;" /></a>
<p>From this plot, we can see that both parameter settings are insufficient and
we have to increase <code class="docutils literal notranslate"><span class="pre">n_cycles</span></code> or <code class="docutils literal notranslate"><span class="pre">length_cycle</span></code> or both of them
(In almost cases, <code class="docutils literal notranslate"><span class="pre">n_warmup_cycles</span></code> has minor effect).</p>
</div>
<div class="section" id="high-frequency-tail-fit">
<h2>High-frequency tail fit<a class="headerlink" href="#high-frequency-tail-fit" title="Permalink to this headline">¶</a></h2>
<p>The self energy computed with QMC becomes noisy at the high frequency region.
This high-frequency tail can be fitted by using the following function:</p>
<div class="math notranslate">
\[\Sigma_{\rm tail}(i \omega) \approx \frac{a_1}{\omega} + \frac{a_2}{\omega^2} +
\frac{a_3}{\omega^3} + \cdots\]</div>
<p>We show the procedure for using this technique.
The original input file (without tail-fit) is as follows (dmft.ini):</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[model]</span>
<span class="na">seedname</span> <span class="o">=</span> <span class="s">bethe</span>
<span class="na">lattice</span> <span class="o">=</span> <span class="s">bethe</span>
<span class="na">norb</span> <span class="o">=</span> <span class="s">1</span>
<span class="na">nelec</span> <span class="o">=</span> <span class="s">1.0</span>
<span class="na">t</span> <span class="o">=</span> <span class="s">1.0</span>
<span class="na">kanamori</span> <span class="o">=</span> <span class="s">[(4.0, 0.0, 0.0)]</span>

<span class="k">[system]</span>
<span class="na">beta</span> <span class="o">=</span> <span class="s">40.0</span>
<span class="na">nk</span> <span class="o">=</span> <span class="s">100</span>

<span class="k">[impurity_solver]</span>
<span class="na">name</span> <span class="o">=</span> <span class="s">TRIQS/cthyb</span>
<span class="na">n_warmup_cycles{int}</span> <span class="o">=</span> <span class="s">10000</span>
<span class="na">n_cycles{int}</span> <span class="o">=</span> <span class="s">100000</span>
<span class="na">length_cycle{int}</span> <span class="o">=</span> <span class="s">50</span>

<span class="k">[control]</span>
<span class="na">max_step</span> <span class="o">=</span> <span class="s">1</span>

<span class="k">[tool]</span>
<span class="na">omega_check</span> <span class="o">=</span> <span class="s">30.0</span>
</pre></div>
</div>
<p>We first execute the ordinary DMFT calculation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ dcore_pre dmft.ini
$ mpiexec -np <span class="m">4</span> dcore dmft.ini
$ dcore_check dmft.ini --output bethe.pdf
</pre></div>
</div>
<p>Then, looking at the figure in bethe.pdf,
we choose the energy range where the tail-fit is performed.</p>
<img alt="../../_images/tailfit.png" class="align-center" id="tailfit" src="../../_images/tailfit.png" />
<p>In this case, we choose energy range from 6 to 15 [red box in (a) in the above figure], and
add the following parameters at the <code class="docutils literal notranslate"><span class="pre">[system]</span></code> block in the input file
(not the
<a class="reference external" href="https://triqs.ipht.cnrs.fr/applications/cthyb/reference/solve_parameters.html">solver parameter</a>
for the tail fit):</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[system]</span>
<span class="na">beta</span> <span class="o">=</span> <span class="s">40.0</span>
<span class="na">nk</span> <span class="o">=</span> <span class="s">100</span>
<span class="na">perform_tail_fit</span> <span class="o">=</span> <span class="s">True</span>
<span class="na">fit_max_moment</span> <span class="o">=</span> <span class="s">2</span>
<span class="na">fit_min_w</span> <span class="o">=</span> <span class="s">6.0</span>
<span class="na">fit_max_w</span> <span class="o">=</span> <span class="s">15.0</span>
</pre></div>
</div>
<p>We run <code class="docutils literal notranslate"><span class="pre">dcore_check</span></code> again, and obtain the result as (b) in the above figure.
If necessary, we repeat editing the input file and running <code class="docutils literal notranslate"><span class="pre">dcore_check</span></code> to refine the energy range.
After the energy range is fixed, we again perform the QMC calculation by <code class="docutils literal notranslate"><span class="pre">dcore</span></code>. The final result looks like (c) in the
above figure.</p>
</div>
<div class="section" id="multi-band-system">
<h2>Multi-band system<a class="headerlink" href="#multi-band-system" title="Permalink to this headline">¶</a></h2>
<p>For the multi-band systems, <strong>we have to include the two-pairs insertion/removal move</strong>
in the QMC cycles as</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[impurity_solver]</span>
<span class="na">name</span> <span class="o">=</span> <span class="s">TRIQS/cthyb</span>
<span class="na">move_double{bool}</span> <span class="o">=</span> <span class="s">True</span>
</pre></div>
</div>
<p>because these moves are disabled in the default setting.</p>
</div>
<div class="section" id="pade-approximation-for-dos-and-spectrum-function">
<h2>Pade approximation for DOS and spectrum function<a class="headerlink" href="#pade-approximation-for-dos-and-spectrum-function" title="Permalink to this headline">¶</a></h2>
<p>To obtain spectral functions, we need to perform analytical continuation from Matsubara frequency to real frequency.
Currently, the Pade approximation is the only choice for the analytical continuation.</p>
<p>There is one control parameter for Pade approximation, <code class="docutils literal notranslate"><span class="pre">omega_pade</span></code> in the <code class="docutils literal notranslate"><span class="pre">[tool]</span></code> block. It specifies an energy cutoff for Matsubara frequency.
A reasonable choice of <code class="docutils literal notranslate"><span class="pre">omega_pade</span></code> is the maximum frequency
before the self energy becomes noisy.
For example, in the case of figure (a) above, we can find that <code class="docutils literal notranslate"><span class="pre">omega_pade=4.0</span></code> is reasonable.</p>
</div>
<div class="section" id="legendre-filter">
<h2>Legendre filter<a class="headerlink" href="#legendre-filter" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Do not use it together with the tail-fit.</p>
</div>
<p>This is another technique to reduce the high-frequency noise.
In this method, we expand the Green’s function at the imaginary time with a series of
the Legendre polynomials, and ignore the higher order polynomials.</p>
<p>This scheme is activated when we specify the input parameter <code class="docutils literal notranslate"><span class="pre">n_l</span></code>
(the number of polynomial included) in the <code class="docutils literal notranslate"><span class="pre">[system]</span></code> block as</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[system]</span>
<span class="na">beta</span> <span class="o">=</span> <span class="s">40.0</span>
<span class="na">nk</span> <span class="o">=</span> <span class="s">100</span>
<span class="na">n_l</span> <span class="o">=</span> <span class="s">30</span>
</pre></div>
</div>
<p>When we use the Legendre filter, we should check that how many polynomials
have to be included.
For this purpose, we first perform a calculation with a large number of Legendre
polynomials (e.g. <code class="docutils literal notranslate"><span class="pre">n_l=80</span></code>) and check how the coefficient decays.</p>
<p>For examples, we run the bash script as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

cat &gt; pre.ini <span class="s">&lt;&lt;EOF</span>
<span class="s">[model]</span>
<span class="s">seedname = bethe</span>
<span class="s">lattice = bethe</span>
<span class="s">norb = 1</span>
<span class="s">nelec = 1.0</span>
<span class="s">t = 1.0</span>
<span class="s">kanamori = [(4.0, 0.0, 0.0)]</span>

<span class="s">[system]</span>
<span class="s">beta = 40.0</span>
<span class="s">nk = 100</span>
<span class="s">n_l = 30</span>

<span class="s">[impurity_solver]</span>
<span class="s">name = TRIQS/cthyb</span>
<span class="s">n_warmup_cycles{int} = 10000</span>
<span class="s">n_cycles{int} = 10000</span>
<span class="s">length_cycle{int} = 100</span>

<span class="s">[control]</span>
<span class="s">max_step = 1</span>
<span class="s">EOF</span>

dcore_pre pre.ini

n_cycles<span class="o">[</span><span class="m">0</span><span class="o">]=</span><span class="m">3000</span><span class="p">;</span>   n_warmup_cycles<span class="o">[</span><span class="m">0</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">0</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">1</span><span class="o">]=</span><span class="m">10000</span><span class="p">;</span>  n_warmup_cycles<span class="o">[</span><span class="m">1</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">1</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">2</span><span class="o">]=</span><span class="m">30000</span><span class="p">;</span>  n_warmup_cycles<span class="o">[</span><span class="m">2</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">2</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">3</span><span class="o">]=</span><span class="m">100000</span><span class="p">;</span> n_warmup_cycles<span class="o">[</span><span class="m">3</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">3</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">4</span><span class="o">]=</span><span class="m">300000</span><span class="p">;</span> n_warmup_cycles<span class="o">[</span><span class="m">4</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">4</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">5</span><span class="o">]=</span><span class="m">300000</span><span class="p">;</span> n_warmup_cycles<span class="o">[</span><span class="m">5</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">5</span><span class="o">]=</span><span class="m">100</span>

<span class="k">for</span> i in <span class="sb">`</span>seq <span class="m">0</span> <span class="m">5</span><span class="sb">`</span>
<span class="k">do</span>
    sed -e <span class="s2">&quot;/n_cycles/c n_cycles{int} = </span><span class="si">${</span><span class="nv">n_cycles</span><span class="p">[i]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="se">\</span>
        -e <span class="s2">&quot;/n_wamup_cycles/c n_warmup_cycles{int} = </span><span class="si">${</span><span class="nv">n_wamup_cycles</span><span class="p">[i]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="se">\</span>
        -e <span class="s2">&quot;/length_cycle/c length_cycle{int} = </span><span class="si">${</span><span class="nv">length_cycle</span><span class="p">[i]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="se">\</span>
    pre.ini &gt; dmft.ini
    mpiexec -np <span class="m">4</span> dcore dmft.ini
    dcore_check dmft.ini --output bethe.pdf
    mv bethe_legendre.dat l_cyc<span class="si">${</span><span class="nv">n_cycles</span><span class="p">[i]</span><span class="si">}</span>_warm<span class="si">${</span><span class="nv">n_warmup_cycles</span><span class="p">[i]</span><span class="si">}</span>_len<span class="si">${</span><span class="nv">length_cycle</span><span class="p">[i]</span><span class="si">}</span>.dat
<span class="k">done</span>
</pre></div>
</div>
<p>Then, we use GnuPlot as</p>
<div class="highlight-gnuplot notranslate"><div class="highlight"><pre><span></span>gnuplot&gt; set xlabel &quot;Order of polynomial&quot;
gnuplot&gt; set ylabel &quot;Coefficient&quot;
gnuplot&gt; set logscale y
gnuplot&gt; plot \
&quot;l_cyc3000_warm5000_len50.dat&quot; u 1:(abs($2)) w l lw 3, \
&quot;l_cyc10000_warm5000_len50.dat&quot; u 1:(abs($2)) w l lw 3, \
&quot;l_cyc30000_warm5000_len50.dat&quot; u 1:(abs($2)) w l lw 3, \
&quot;l_cyc100000_warm5000_len50.dat&quot; u 1:(abs($2)) w l lw 3, \
&quot;l_cyc300000_warm5000_len50.dat&quot; u 1:(abs($2)) w l lw 3, \
&quot;l_cyc300000_warm5000_len100.dat&quot; u 1:(abs($2)) w l lw 3
</pre></div>
</div>
<p>and obtain</p>
<a class="reference internal image-reference" href="../../_images/legendre.png"><img alt="../../_images/legendre.png" class="align-center" src="../../_images/legendre.png" style="width: 500px;" /></a>
<p>Finally, we choose the following setting:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[model]</span>
<span class="na">seedname</span> <span class="o">=</span> <span class="s">bethe</span>
<span class="na">lattice</span> <span class="o">=</span> <span class="s">bethe</span>
<span class="na">norb</span> <span class="o">=</span> <span class="s">1</span>
<span class="na">nelec</span> <span class="o">=</span> <span class="s">1.0</span>
<span class="na">t</span> <span class="o">=</span> <span class="s">1.0</span>
<span class="na">kanamori</span> <span class="o">=</span> <span class="s">[(4.0, 0.0, 0.0)]</span>

<span class="k">[system]</span>
<span class="na">beta</span> <span class="o">=</span> <span class="s">40.0</span>
<span class="na">nk</span> <span class="o">=</span> <span class="s">100</span>
<span class="na">n_l</span> <span class="o">=</span> <span class="s">30</span>

<span class="k">[impurity_solver]</span>
<span class="na">name</span> <span class="o">=</span> <span class="s">TRIQS/cthyb</span>
<span class="na">n_warmup_cycles{int}</span> <span class="o">=</span> <span class="s">5000</span>
<span class="na">n_cycles{int}</span> <span class="o">=</span> <span class="s">300000</span>
<span class="na">length_cycle{int}</span> <span class="o">=</span> <span class="s">100</span>

<span class="k">[control]</span>
<span class="na">max_step</span> <span class="o">=</span> <span class="s">1</span>

<span class="k">[tool]</span>
<span class="na">omega_check</span> <span class="o">=</span> <span class="s">30.0</span>
</pre></div>
</div>
<p>and obtain</p>
<a class="reference internal image-reference" href="../../_images/legendre_sigma.png"><img alt="../../_images/legendre_sigma.png" class="align-center" src="../../_images/legendre_sigma.png" style="width: 500px;" /></a>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../reference/programs.html" title="Programs"
             >next</a> |</li>
        <li class="right" >
          <a href="alps_cthyb.html" title="How to choose parameters for ALPS/cthyb"
             >previous</a> |</li>
    <li><a href="../../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../documentation.html" >Documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, The University of Tokyo.
    </div>
  </body>
</html>