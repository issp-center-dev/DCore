
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CT-QMC: TRIQS/cthyb &#8212; DCore  documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/wild.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/dcore.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="CT-QMC with segment implementation: ALPS/CT-HYB-SEGMENT" href="../alpscore_ctseg/ctseg.html" />
    <link rel="prev" title="CT-QMC: ALPS/CT-HYB" href="../alpscore_cthyb/cthyb.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../alpscore_ctseg/ctseg.html" title="CT-QMC with segment implementation: ALPS/CT-HYB-SEGMENT"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="../alpscore_cthyb/cthyb.html" title="CT-QMC: ALPS/CT-HYB"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">DCore  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../reference.html" >Reference Manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../impuritysolvers.html" accesskey="U">Impurity solvers</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">CT-QMC: <code class="docutils literal notranslate"><span class="pre">TRIQS/cthyb</span></code></a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="ct-qmc-triqs-cthyb">
<span id="howtocthyb"></span><h1>CT-QMC: <code class="docutils literal notranslate"><span class="pre">TRIQS/cthyb</span></code><a class="headerlink" href="#ct-qmc-triqs-cthyb" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This document was written for ver.1.x, and might include descriptions incompatible with the latest version.
If you encounter some problem, see the release note of ver.2.0 and check the differences between ver.1.x and ver.2.0.</p>
</div>
<div class="section" id="install">
<h2>Install<a class="headerlink" href="#install" title="Permalink to this headline">¶</a></h2>
<p>Follow the installation guide in <a class="reference external" href="https://triqs.github.io/cthyb/1.4/">TRIQS/cthyb</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><p>Checkout tag <strong>1.4.2</strong> on master branch, or download the released package
from <a class="reference external" href="https://github.com/TRIQS/cthyb/releases/tag/1.4.2">here</a>.</p></li>
<li><p>Be sure to use the same C++ compiler as the one used to build the <code class="docutils literal notranslate"><span class="pre">TRIQS</span></code> library.</p></li>
<li><p>If you want to treat the spin-orbit coupling in <code class="docutils literal notranslate"><span class="pre">TRIQS/cthyb</span></code> solver,
it must be built with the following CMake options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">DHYBRIDISATION_IS_COMPLEX</span><span class="o">=</span><span class="n">ON</span> <span class="o">-</span><span class="n">DLOCAL_HAMILTONIAN_IS_COMPLEX</span><span class="o">=</span><span class="n">ON</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="basic-parameters-for-qmc">
<h2>Basic parameters for QMC<a class="headerlink" href="#basic-parameters-for-qmc" title="Permalink to this headline">¶</a></h2>
<p>The accuracy of the TRIQS/cthyb calculation depends on mainly the following
three parameters.</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">n_cycles{int}</span></code></p>
<p>The number of QMC cycles for computing any quantities.
The numerical noise can be reduced by increasing this parameter.</p>
<p>When we use the MPI parallelism, the total number of QMC cycle
( <code class="docutils literal notranslate"><span class="pre">number-of-processes</span> <span class="pre">*</span> <span class="pre">n_cycles</span></code>) affects the accuracy.
Therefore,
<strong>n_cycles in inverse proportion to the number of MPI processes keeps the accuracy</strong>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_warmup_cycles{int}</span></code></p>
<p>The number of QMC cycles for the thermalization before the above main calculation.
If it is insufficient, the state to be computed may be different from the
equilibrium state.</p>
<p><strong>This parameter is independent of the MPI parallelism.</strong></p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">length_cycle{int}</span></code></p>
<p>Each QMC cycles have sub-cycles.
The length of this sub-cycle should be long enough to escape from the auto-correlation.</p>
<p><strong>This parameter is independent of the MPI parallelism.</strong></p>
</li>
</ul>
</div></blockquote>
<p>The computational time is proportional to <code class="docutils literal notranslate"><span class="pre">length_cycle*(n_cycles+n_warmup_cycles)</span></code>.
The following script is an example to describe the procedure for searching appropriate QMC parameter.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

cat &gt; pre.ini <span class="s">&lt;&lt;EOF</span>
<span class="s">[model]</span>
<span class="s">seedname = bethe</span>
<span class="s">lattice = bethe</span>
<span class="s">norb = 1</span>
<span class="s">nelec = 1.0</span>
<span class="s">t = 1.0</span>
<span class="s">kanamori = [(4.0, 0.0, 0.0)]</span>

<span class="s">[system]</span>
<span class="s">beta = 40.0</span>
<span class="s">nk = 100</span>

<span class="s">[impurity_solver]</span>
<span class="s">name = TRIQS/cthyb</span>
<span class="s">n_warmup_cycles{int} = 10000</span>
<span class="s">n_cycles{int} = 10000</span>
<span class="s">length_cycle{int} = 100</span>

<span class="s">[control]</span>
<span class="s">max_step = 1</span>
<span class="s">EOF</span>

dcore_pre pre.ini

n_cycles<span class="o">[</span><span class="m">0</span><span class="o">]=</span><span class="m">3000</span><span class="p">;</span>   n_warmup_cycles<span class="o">[</span><span class="m">0</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">0</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">1</span><span class="o">]=</span><span class="m">10000</span><span class="p">;</span>  n_warmup_cycles<span class="o">[</span><span class="m">1</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">1</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">2</span><span class="o">]=</span><span class="m">30000</span><span class="p">;</span>  n_warmup_cycles<span class="o">[</span><span class="m">2</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">2</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">3</span><span class="o">]=</span><span class="m">100000</span><span class="p">;</span> n_warmup_cycles<span class="o">[</span><span class="m">3</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">3</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">4</span><span class="o">]=</span><span class="m">300000</span><span class="p">;</span> n_warmup_cycles<span class="o">[</span><span class="m">4</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">4</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">5</span><span class="o">]=</span><span class="m">300000</span><span class="p">;</span> n_warmup_cycles<span class="o">[</span><span class="m">5</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">5</span><span class="o">]=</span><span class="m">100</span>

<span class="k">for</span> i in <span class="sb">`</span>seq <span class="m">0</span> <span class="m">5</span><span class="sb">`</span>
<span class="k">do</span>
    sed -e <span class="s2">&quot;/n_cycles/c n_cycles{int} = </span><span class="si">${</span><span class="nv">n_cycles</span><span class="p">[i]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="se">\</span>
        -e <span class="s2">&quot;/n_wamup_cycles/c n_warmup_cycles{int} = </span><span class="si">${</span><span class="nv">n_wamup_cycles</span><span class="p">[i]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="se">\</span>
        -e <span class="s2">&quot;/length_cycle/c length_cycle{int} = </span><span class="si">${</span><span class="nv">length_cycle</span><span class="p">[i]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="se">\</span>
    pre.ini &gt; dmft.ini
    mpiexec -np <span class="m">4</span> dcore dmft.ini
    dcore_check dmft.ini --output bethe.pdf
    mv bethe_sigma.dat cyc<span class="si">${</span><span class="nv">n_cycles</span><span class="p">[i]</span><span class="si">}</span>_warm<span class="si">${</span><span class="nv">n_warmup_cycles</span><span class="p">[i]</span><span class="si">}</span>_len<span class="si">${</span><span class="nv">length_cycle</span><span class="p">[i]</span><span class="si">}</span>.dat
<span class="k">done</span>
</pre></div>
</div>
<p>Then, we use gnuplot as</p>
<div class="highlight-gnuplot notranslate"><div class="highlight"><pre><span></span><span class="k">plot</span> <span class="p">[</span><span class="mi">0</span><span class="o">:</span><span class="mi">10</span><span class="p">][</span><span class="mi">-0</span><span class="mf">.6</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span> \
<span class="s">&quot;cyc3000_warm5000_len50.dat&quot;</span> <span class="nb">u</span> <span class="mi">1</span><span class="o">:</span><span class="mi">3</span> <span class="nb">w</span> <span class="n">l</span> <span class="n">lw</span> <span class="mi">3</span><span class="o">,</span> \
<span class="s">&quot;cyc10000_warm5000_len50.dat&quot;</span> <span class="nb">u</span> <span class="mi">1</span><span class="o">:</span><span class="mi">3</span> <span class="nb">w</span> <span class="n">l</span> <span class="n">lw</span> <span class="mi">3</span><span class="o">,</span> \
<span class="s">&quot;cyc30000_warm5000_len50.dat&quot;</span> <span class="nb">u</span> <span class="mi">1</span><span class="o">:</span><span class="mi">3</span> <span class="nb">w</span> <span class="n">l</span> <span class="n">lw</span> <span class="mi">3</span><span class="o">,</span> \
<span class="s">&quot;cyc100000_warm5000_len50.dat&quot;</span> <span class="nb">u</span> <span class="mi">1</span><span class="o">:</span><span class="mi">3</span> <span class="nb">w</span> <span class="n">l</span> <span class="n">lw</span> <span class="mi">3</span><span class="o">,</span> \
<span class="s">&quot;cyc300000_warm5000_len50.dat&quot;</span> <span class="nb">u</span> <span class="mi">1</span><span class="o">:</span><span class="mi">3</span> <span class="nb">w</span> <span class="n">l</span> <span class="n">lw</span> <span class="mi">3</span><span class="o">,</span> \
<span class="s">&quot;cyc300000_warm5000_len100.dat&quot;</span> <span class="nb">u</span> <span class="mi">1</span><span class="o">:</span><span class="mi">3</span> <span class="nb">w</span> <span class="n">l</span> <span class="n">lw</span> <span class="mi">3</span>
</pre></div>
</div>
<p>and obtain</p>
<a class="reference internal image-reference" href="../../_images/QMCparam.png"><img alt="../../_images/QMCparam.png" class="align-center" src="../../_images/QMCparam.png" style="width: 500px;" /></a>
<p>From this plot, we can see that both parameter settings are insufficient and
we have to increase <code class="docutils literal notranslate"><span class="pre">n_cycles</span></code> or <code class="docutils literal notranslate"><span class="pre">length_cycle</span></code> or both of them
(In almost cases, <code class="docutils literal notranslate"><span class="pre">n_warmup_cycles</span></code> has minor effect).</p>
</div>
<div class="section" id="high-frequency-tail-fit">
<h2>High-frequency tail fit<a class="headerlink" href="#high-frequency-tail-fit" title="Permalink to this headline">¶</a></h2>
<p>The self energy computed with QMC becomes noisy at the high frequency region.
This high-frequency tail can be fitted by using the following function:</p>
<div class="math notranslate nohighlight">
\[\Sigma_{\rm tail}(i \omega) \approx \frac{a_1}{\omega} + \frac{a_2}{\omega^2} +
\frac{a_3}{\omega^3} + \cdots\]</div>
<p>We show the procedure for using this technique.
The original input file (without tail-fit) is as follows (dmft.ini):</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[model]</span>
<span class="na">seedname</span> <span class="o">=</span> <span class="s">bethe</span>
<span class="na">lattice</span> <span class="o">=</span> <span class="s">bethe</span>
<span class="na">norb</span> <span class="o">=</span> <span class="s">1</span>
<span class="na">nelec</span> <span class="o">=</span> <span class="s">1.0</span>
<span class="na">t</span> <span class="o">=</span> <span class="s">1.0</span>
<span class="na">kanamori</span> <span class="o">=</span> <span class="s">[(4.0, 0.0, 0.0)]</span>

<span class="k">[system]</span>
<span class="na">beta</span> <span class="o">=</span> <span class="s">40.0</span>
<span class="na">nk</span> <span class="o">=</span> <span class="s">100</span>

<span class="k">[impurity_solver]</span>
<span class="na">name</span> <span class="o">=</span> <span class="s">TRIQS/cthyb</span>
<span class="na">n_warmup_cycles{int}</span> <span class="o">=</span> <span class="s">10000</span>
<span class="na">n_cycles{int}</span> <span class="o">=</span> <span class="s">100000</span>
<span class="na">length_cycle{int}</span> <span class="o">=</span> <span class="s">50</span>

<span class="k">[control]</span>
<span class="na">max_step</span> <span class="o">=</span> <span class="s">1</span>

<span class="k">[tool]</span>
<span class="na">omega_check</span> <span class="o">=</span> <span class="s">30.0</span>
</pre></div>
</div>
<p>We first execute the ordinary DMFT calculation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ dcore_pre dmft.ini
$ mpiexec -np <span class="m">4</span> dcore dmft.ini
$ dcore_check dmft.ini --output bethe.pdf
</pre></div>
</div>
<p>Then, looking at the figure in bethe.pdf,
we choose the energy range where the tail-fit is performed.</p>
<img alt="../../_images/tailfit.png" class="align-center" id="tailfit" src="../../_images/tailfit.png" />
<p>In this case, we choose energy range from 6 to 15 [red box in (a) in the above figure], and
add the following parameters at the <code class="docutils literal notranslate"><span class="pre">[system]</span></code> block in the input file
(not the
<a class="reference external" href="https://triqs.ipht.cnrs.fr/applications/cthyb/reference/solve_parameters.html">solver parameter</a>
for the tail fit):</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[system]</span>
<span class="na">beta</span> <span class="o">=</span> <span class="s">40.0</span>
<span class="na">nk</span> <span class="o">=</span> <span class="s">100</span>
<span class="na">perform_tail_fit</span> <span class="o">=</span> <span class="s">True</span>
<span class="na">fit_max_moment</span> <span class="o">=</span> <span class="s">2</span>
<span class="na">fit_min_w</span> <span class="o">=</span> <span class="s">6.0</span>
<span class="na">fit_max_w</span> <span class="o">=</span> <span class="s">15.0</span>
</pre></div>
</div>
<p>We run <code class="docutils literal notranslate"><span class="pre">dcore_check</span></code> again, and obtain the result as (b) in the above figure.
If necessary, we repeat editing the input file and running <code class="docutils literal notranslate"><span class="pre">dcore_check</span></code> to refine the energy range.
After the energy range is fixed, we again perform the QMC calculation by <code class="docutils literal notranslate"><span class="pre">dcore</span></code>. The final result looks like (c) in the
above figure.</p>
</div>
<div class="section" id="multi-band-system">
<h2>Multi-band system<a class="headerlink" href="#multi-band-system" title="Permalink to this headline">¶</a></h2>
<p>For the multi-band systems, <strong>we have to include the two-pairs insertion/removal move</strong>
in the QMC cycles as</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[impurity_solver]</span>
<span class="na">name</span> <span class="o">=</span> <span class="s">TRIQS/cthyb</span>
<span class="na">move_double{bool}</span> <span class="o">=</span> <span class="s">True</span>
</pre></div>
</div>
<p>because these moves are disabled in the default setting.</p>
</div>
<div class="section" id="pade-approximation-for-dos-and-spectrum-function">
<h2>Pade approximation for DOS and spectrum function<a class="headerlink" href="#pade-approximation-for-dos-and-spectrum-function" title="Permalink to this headline">¶</a></h2>
<p>To obtain spectral functions, we need to perform analytical continuation from Matsubara frequency to real frequency.
Currently, the Pade approximation is the only choice for the analytical continuation.</p>
<p>There is one control parameter for Pade approximation, <code class="docutils literal notranslate"><span class="pre">omega_pade</span></code> in the <code class="docutils literal notranslate"><span class="pre">[tool]</span></code> block. It specifies an energy cutoff for Matsubara frequency.
A reasonable choice of <code class="docutils literal notranslate"><span class="pre">omega_pade</span></code> is the maximum frequency
before the self energy becomes noisy.
For example, in the case of figure (a) above, we can find that <code class="docutils literal notranslate"><span class="pre">omega_pade=4.0</span></code> is reasonable.</p>
</div>
<div class="section" id="legendre-filter">
<h2>Legendre filter<a class="headerlink" href="#legendre-filter" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not use it together with the tail-fit.</p>
</div>
<p>This is another technique to reduce the high-frequency noise.
In this method, we expand the Green’s function at the imaginary time with a series of
the Legendre polynomials, and ignore the higher order polynomials.</p>
<p>This scheme is activated when we specify the input parameter <code class="docutils literal notranslate"><span class="pre">n_l</span></code>
(the number of polynomial included) in the <code class="docutils literal notranslate"><span class="pre">[system]</span></code> block as</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[system]</span>
<span class="na">beta</span> <span class="o">=</span> <span class="s">40.0</span>
<span class="na">nk</span> <span class="o">=</span> <span class="s">100</span>
<span class="na">n_l</span> <span class="o">=</span> <span class="s">30</span>
</pre></div>
</div>
<p>When we use the Legendre filter, we should check that how many polynomials
have to be included.
For this purpose, we first perform a calculation with a large number of Legendre
polynomials (e.g. <code class="docutils literal notranslate"><span class="pre">n_l=80</span></code>) and check how the coefficient decays.</p>
<p>For examples, we run the bash script as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

cat &gt; pre.ini <span class="s">&lt;&lt;EOF</span>
<span class="s">[model]</span>
<span class="s">seedname = bethe</span>
<span class="s">lattice = bethe</span>
<span class="s">norb = 1</span>
<span class="s">nelec = 1.0</span>
<span class="s">t = 1.0</span>
<span class="s">kanamori = [(4.0, 0.0, 0.0)]</span>

<span class="s">[system]</span>
<span class="s">beta = 40.0</span>
<span class="s">nk = 100</span>
<span class="s">n_l = 30</span>

<span class="s">[impurity_solver]</span>
<span class="s">name = TRIQS/cthyb</span>
<span class="s">n_warmup_cycles{int} = 10000</span>
<span class="s">n_cycles{int} = 10000</span>
<span class="s">length_cycle{int} = 100</span>

<span class="s">[control]</span>
<span class="s">max_step = 1</span>
<span class="s">EOF</span>

dcore_pre pre.ini

n_cycles<span class="o">[</span><span class="m">0</span><span class="o">]=</span><span class="m">3000</span><span class="p">;</span>   n_warmup_cycles<span class="o">[</span><span class="m">0</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">0</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">1</span><span class="o">]=</span><span class="m">10000</span><span class="p">;</span>  n_warmup_cycles<span class="o">[</span><span class="m">1</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">1</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">2</span><span class="o">]=</span><span class="m">30000</span><span class="p">;</span>  n_warmup_cycles<span class="o">[</span><span class="m">2</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">2</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">3</span><span class="o">]=</span><span class="m">100000</span><span class="p">;</span> n_warmup_cycles<span class="o">[</span><span class="m">3</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">3</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">4</span><span class="o">]=</span><span class="m">300000</span><span class="p">;</span> n_warmup_cycles<span class="o">[</span><span class="m">4</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">4</span><span class="o">]=</span><span class="m">50</span>
n_cycles<span class="o">[</span><span class="m">5</span><span class="o">]=</span><span class="m">300000</span><span class="p">;</span> n_warmup_cycles<span class="o">[</span><span class="m">5</span><span class="o">]=</span><span class="m">5000</span><span class="p">;</span> length_cycle<span class="o">[</span><span class="m">5</span><span class="o">]=</span><span class="m">100</span>

<span class="k">for</span> i in <span class="sb">`</span>seq <span class="m">0</span> <span class="m">5</span><span class="sb">`</span>
<span class="k">do</span>
    sed -e <span class="s2">&quot;/n_cycles/c n_cycles{int} = </span><span class="si">${</span><span class="nv">n_cycles</span><span class="p">[i]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="se">\</span>
        -e <span class="s2">&quot;/n_wamup_cycles/c n_warmup_cycles{int} = </span><span class="si">${</span><span class="nv">n_wamup_cycles</span><span class="p">[i]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="se">\</span>
        -e <span class="s2">&quot;/length_cycle/c length_cycle{int} = </span><span class="si">${</span><span class="nv">length_cycle</span><span class="p">[i]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="se">\</span>
    pre.ini &gt; dmft.ini
    mpiexec -np <span class="m">4</span> dcore dmft.ini
    dcore_check dmft.ini --output bethe.pdf
    mv bethe_legendre.dat l_cyc<span class="si">${</span><span class="nv">n_cycles</span><span class="p">[i]</span><span class="si">}</span>_warm<span class="si">${</span><span class="nv">n_warmup_cycles</span><span class="p">[i]</span><span class="si">}</span>_len<span class="si">${</span><span class="nv">length_cycle</span><span class="p">[i]</span><span class="si">}</span>.dat
<span class="k">done</span>
</pre></div>
</div>
<p>Then, we use GnuPlot as</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>set xlabel &quot;Order of polynomial&quot;
set ylabel &quot;Coefficient&quot;
set logscale y
plot \
&quot;l_cyc3000_warm5000_len50.dat&quot; u 1:(abs($2)) w l lw 3, \
&quot;l_cyc10000_warm5000_len50.dat&quot; u 1:(abs($2)) w l lw 3, \
&quot;l_cyc30000_warm5000_len50.dat&quot; u 1:(abs($2)) w l lw 3, \
&quot;l_cyc100000_warm5000_len50.dat&quot; u 1:(abs($2)) w l lw 3, \
&quot;l_cyc300000_warm5000_len50.dat&quot; u 1:(abs($2)) w l lw 3, \
&quot;l_cyc300000_warm5000_len100.dat&quot; u 1:(abs($2)) w l lw 3
</pre></div>
</div>
<p>and obtain</p>
<a class="reference internal image-reference" href="../../_images/legendre.png"><img alt="../../_images/legendre.png" class="align-center" src="../../_images/legendre.png" style="width: 500px;" /></a>
<p>Finally, we choose the following setting:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[model]</span>
<span class="na">seedname</span> <span class="o">=</span> <span class="s">bethe</span>
<span class="na">lattice</span> <span class="o">=</span> <span class="s">bethe</span>
<span class="na">norb</span> <span class="o">=</span> <span class="s">1</span>
<span class="na">nelec</span> <span class="o">=</span> <span class="s">1.0</span>
<span class="na">t</span> <span class="o">=</span> <span class="s">1.0</span>
<span class="na">kanamori</span> <span class="o">=</span> <span class="s">[(4.0, 0.0, 0.0)]</span>

<span class="k">[system]</span>
<span class="na">beta</span> <span class="o">=</span> <span class="s">40.0</span>
<span class="na">nk</span> <span class="o">=</span> <span class="s">100</span>
<span class="na">n_l</span> <span class="o">=</span> <span class="s">30</span>

<span class="k">[impurity_solver]</span>
<span class="na">name</span> <span class="o">=</span> <span class="s">TRIQS/cthyb</span>
<span class="na">n_warmup_cycles{int}</span> <span class="o">=</span> <span class="s">5000</span>
<span class="na">n_cycles{int}</span> <span class="o">=</span> <span class="s">300000</span>
<span class="na">length_cycle{int}</span> <span class="o">=</span> <span class="s">100</span>

<span class="k">[control]</span>
<span class="na">max_step</span> <span class="o">=</span> <span class="s">1</span>

<span class="k">[tool]</span>
<span class="na">omega_check</span> <span class="o">=</span> <span class="s">30.0</span>
</pre></div>
</div>
<p>and obtain</p>
<a class="reference internal image-reference" href="../../_images/legendre_sigma.png"><img alt="../../_images/legendre_sigma.png" class="align-center" src="../../_images/legendre_sigma.png" style="width: 500px;" /></a>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about.html">DCore</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../reference.html">Reference Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../reference/programs.html">Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/input.html">Input-file format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/output.html">Output-file format</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../impuritysolvers.html">Impurity solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tools.html">Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../support.html">Support</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../alpscore_cthyb/cthyb.html"
                        title="previous chapter">CT-QMC: <code class="docutils literal notranslate"><span class="pre">ALPS/CT-HYB</span></code></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../alpscore_ctseg/ctseg.html"
                        title="next chapter">CT-QMC with segment implementation: <code class="docutils literal notranslate"><span class="pre">ALPS/CT-HYB-SEGMENT</span></code></a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../alpscore_ctseg/ctseg.html" title="CT-QMC with segment implementation: ALPS/CT-HYB-SEGMENT"
             >next</a></li>
        <li class="right" >
          <a href="../alpscore_cthyb/cthyb.html" title="CT-QMC: ALPS/CT-HYB"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">DCore  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../reference.html" >Reference Manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../impuritysolvers.html" >Impurity solvers</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">CT-QMC: <code class="docutils literal notranslate"><span class="pre">TRIQS/cthyb</span></code></a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, The University of Tokyo.
    </div>
  </body>
</html>