<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>FAQ/Troubleshooting &#8212; DCore  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5349f25f" />
    <link rel="stylesheet" type="text/css" href="../_static/wild.css?v=755527b2" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/dcore.css?v=1e19043f" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Reporting issues" href="issues.html" />
    <link rel="prev" title="Support" href="../support.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="issues.html" title="Reporting issues"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="../support.html" title="Support"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">DCore  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../support.html" accesskey="U">Support</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">FAQ/Troubleshooting</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="faq-troubleshooting">
<h1>FAQ/Troubleshooting<a class="headerlink" href="#faq-troubleshooting" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#general" id="id1">General</a></p>
<ul>
<li><p><a class="reference internal" href="#can-dcore-compute-the-double-occupancy" id="id2">Can <strong>DCore</strong> compute the double occupancy?</a></p></li>
<li><p><a class="reference internal" href="#can-dcore-compute-the-internal-energy" id="id3">Can <strong>DCore</strong> compute the internal energy?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#dcore-pre" id="id4"><code class="docutils literal notranslate"><span class="pre">dcore_pre</span></code></a></p>
<ul>
<li><p><a class="reference internal" href="#when-should-i-re-execute-dcore-pre" id="id5">When should I re-execute <code class="docutils literal notranslate"><span class="pre">dcore_pre</span></code>?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#dcore" id="id6"><code class="docutils literal notranslate"><span class="pre">dcore</span></code></a></p>
<ul>
<li><p><a class="reference internal" href="#how-should-i-judge-convergence-of-the-dmft-loop" id="id7">How should I judge convergence of the DMFT loop?</a></p></li>
<li><p><a class="reference internal" href="#the-dmft-loop-does-not-converge" id="id8">The DMFT loop does not converge</a></p></li>
<li><p><a class="reference internal" href="#can-i-enforce-zero-magnetic-moment" id="id9">Can I enforce zero magnetic moment?</a></p></li>
<li><p><a class="reference internal" href="#can-i-fix-the-sign-of-the-magnetic-moment-in-ordered-states" id="id10">Can I fix the sign of the magnetic moment in ordered states?</a></p></li>
<li><p><a class="reference internal" href="#can-i-set-an-initial-self-energy-for-the-dmft-loop" id="id11">Can I set an initial self-energy for the DMFT loop?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#dcore-check" id="id12"><code class="docutils literal notranslate"><span class="pre">dcore_check</span></code></a></p>
<ul>
<li><p><a class="reference internal" href="#can-i-change-the-file-format-for-figures" id="id13">Can I change the file format for figures?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#impurity-solvers" id="id14">Impurity solvers</a></p>
<ul>
<li><p><a class="reference internal" href="#what-is-the-difference-between-alps-ct-hyb-and-triqs-cthyb" id="id15">What is the difference between ALPS/CT-HYB and TRIQS/cthyb?</a></p></li>
<li><p><a class="reference internal" href="#solver-dependent-parameter-is-not-recognized" id="id16">Solver-dependent parameter is not recognized</a></p></li>
<li><p><a class="reference internal" href="#can-i-use-my-impurity-solver" id="id17">Can I use my impurity solver?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#others" id="id18">Others</a></p>
<ul>
<li><p><a class="reference internal" href="#dcore-is-slow-even-with-mpi-parallelization" id="id19">DCore is slow even with MPI parallelization</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="general">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">General</a><a class="headerlink" href="#general" title="Permalink to this heading">¶</a></h2>
<section id="can-dcore-compute-the-double-occupancy">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">Can <strong>DCore</strong> compute the double occupancy?</a><a class="headerlink" href="#can-dcore-compute-the-double-occupancy" title="Permalink to this heading">¶</a></h3>
<p>It depends on impurity solvers.
For example, ALPS/CT-HYB-SEGMENT supports it, but other CT-QMC codes do not at present.</p>
<p>In general, capability of computing <strong>local</strong> physical quantities totally depends on impurity solvers.
See the documentation of each solver for which local quantities can be computed.</p>
</section>
<section id="can-dcore-compute-the-internal-energy">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">Can <strong>DCore</strong> compute the internal energy?</a><a class="headerlink" href="#can-dcore-compute-the-internal-energy" title="Permalink to this heading">¶</a></h3>
<p>No, it is not implemented yet.</p>
<p>If you want to compute it, you need to access to G(k,iw) in HDF5 file, and take summation over k and iw in an appropiate way.</p>
</section>
</section>
<section id="dcore-pre">
<h2><a class="toc-backref" href="#id4" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">dcore_pre</span></code></a><a class="headerlink" href="#dcore-pre" title="Permalink to this heading">¶</a></h2>
<section id="when-should-i-re-execute-dcore-pre">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">When should I re-execute <code class="docutils literal notranslate"><span class="pre">dcore_pre</span></code>?</a><a class="headerlink" href="#when-should-i-re-execute-dcore-pre" title="Permalink to this heading">¶</a></h3>
<p>When you change any parameters in <strong>[model] block</strong>.
<code class="docutils literal notranslate"><span class="pre">dcore_pre</span></code> will re-construct the model database in <em>seedname</em>.h5.</p>
<p>For changes of parameters other than [model] block, on the other hand, you can restart <code class="docutils literal notranslate"><span class="pre">dcore</span></code>, skipping <code class="docutils literal notranslate"><span class="pre">dcore_pre</span></code>.</p>
</section>
</section>
<section id="dcore">
<h2><a class="toc-backref" href="#id6" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">dcore</span></code></a><a class="headerlink" href="#dcore" title="Permalink to this heading">¶</a></h2>
<section id="how-should-i-judge-convergence-of-the-dmft-loop">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">How should I judge convergence of the DMFT loop?</a><a class="headerlink" href="#how-should-i-judge-convergence-of-the-dmft-loop" title="Permalink to this heading">¶</a></h3>
<p>The most reliable way is to use the <code class="docutils literal notranslate"><span class="pre">dcore_check</span></code> and look at the generated figures that plot some physical quantities as a function of iterations.</p>
<p>Automatic convergence check is also available. Use <code class="docutils literal notranslate"><span class="pre">converge_tol</span></code> parameter in [control] block. For QMC calculations, we rocommend to use <code class="docutils literal notranslate"><span class="pre">n_converge</span></code> parameter simultaneously to exclude possibility that the convergence criteria is satisfied accidentally. An appropriate value would be <code class="docutils literal notranslate"><span class="pre">n_converge=3</span></code> or larger.</p>
</section>
<section id="the-dmft-loop-does-not-converge">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">The DMFT loop does not converge</a><a class="headerlink" href="#the-dmft-loop-does-not-converge" title="Permalink to this heading">¶</a></h3>
<p>If the chemical potential and/or self-energy look oscillating as a function of the iteration number, decrease <code class="docutils literal notranslate"><span class="pre">sigma_mix</span></code> parameter in [control] block.</p>
<p>You might also need to improve the accuracy of QMC sampling by increasing the measurement time.</p>
<p>If the oscillation persists, consider expanding the unitcell to address a symmetry broken solution.</p>
</section>
<section id="can-i-enforce-zero-magnetic-moment">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Can I enforce zero magnetic moment?</a><a class="headerlink" href="#can-i-enforce-zero-magnetic-moment" title="Permalink to this heading">¶</a></h3>
<p>Yes. Use <code class="docutils literal notranslate"><span class="pre">time_reversal</span></code> flag in [control] block.
See <a class="reference internal" href="../reference/input.html"><span class="doc">Input-file format</span></a>.</p>
</section>
<section id="can-i-fix-the-sign-of-the-magnetic-moment-in-ordered-states">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Can I fix the sign of the magnetic moment in ordered states?</a><a class="headerlink" href="#can-i-fix-the-sign-of-the-magnetic-moment-in-ordered-states" title="Permalink to this heading">¶</a></h3>
<p>Yes. Set the initial static self-energy using <code class="docutils literal notranslate"><span class="pre">initial_static_self_energy</span></code> parameter in [control] block.
This works as a local potential in the first iteration.
See <a class="reference internal" href="../reference/input.html"><span class="doc">Input-file format</span></a> for details.</p>
</section>
<section id="can-i-set-an-initial-self-energy-for-the-dmft-loop">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Can I set an initial self-energy for the DMFT loop?</a><a class="headerlink" href="#can-i-set-an-initial-self-energy-for-the-dmft-loop" title="Permalink to this heading">¶</a></h3>
<p>Yes. Use <code class="docutils literal notranslate"><span class="pre">initial_self_energy</span></code> parameter in [control] block.
See <a class="reference internal" href="../reference/input.html"><span class="doc">Input-file format</span></a>.</p>
<p>Let’s say you want to start the DMFT loop using results obtained for different parameter set.
To do this, you perform <code class="docutils literal notranslate"><span class="pre">dcore_check</span></code> after convergence, and copy <strong>sigma.dat</strong> into a new working directory (with the name sigma_init.dat below).
Then, assign this file to <code class="docutils literal notranslate"><span class="pre">initial_self_energy</span></code> parameter as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">control</span><span class="p">]</span>
<span class="n">initial_self_energy</span> <span class="o">=</span> <span class="n">sigma_init</span><span class="o">.</span><span class="n">dat</span>
</pre></div>
</div>
</section>
</section>
<section id="dcore-check">
<h2><a class="toc-backref" href="#id12" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">dcore_check</span></code></a><a class="headerlink" href="#dcore-check" title="Permalink to this heading">¶</a></h2>
<section id="can-i-change-the-file-format-for-figures">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Can I change the file format for figures?</a><a class="headerlink" href="#can-i-change-the-file-format-for-figures" title="Permalink to this heading">¶</a></h3>
<p>Yes. Use <code class="docutils literal notranslate"><span class="pre">--ext</span></code> option to specify the file extension.
If you prefer PDF, for example, the command reads</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ dcore_check input.init --ext pdf
</pre></div>
</div>
<p>The argument of <code class="docutils literal notranslate"><span class="pre">--ext</span></code> can be png, pdf, eps, jpg, … (the ones supported by <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> module).</p>
</section>
</section>
<section id="impurity-solvers">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Impurity solvers</a><a class="headerlink" href="#impurity-solvers" title="Permalink to this heading">¶</a></h2>
<section id="what-is-the-difference-between-alps-ct-hyb-and-triqs-cthyb">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">What is the difference between ALPS/CT-HYB and TRIQS/cthyb?</a><a class="headerlink" href="#what-is-the-difference-between-alps-ct-hyb-and-triqs-cthyb" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ALPS/CT-HYB</span></code> is developed by one of the main developers of DCore, H. Shinaoka.
Both of <code class="docutils literal notranslate"><span class="pre">ALPS/CT-HYB</span></code> and <code class="docutils literal notranslate"><span class="pre">TRIQS/cthyb</span></code> implement the hybridization-expansion continuous-time quantum Monte Carlo method.
The main difference is the reliability of measurement of the single-particle Green’s function.
ALPS/CT-HYB uses a more elaborate algorithm (worm sampling).
The non-worm conventional sampling, which is implemented in <code class="docutils literal notranslate"><span class="pre">TRIQS/cthyb</span></code>,
may give wrong results in some situations (e.g. SOI coupling with orbital-diagonal bath).</p>
</section>
<section id="solver-dependent-parameter-is-not-recognized">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Solver-dependent parameter is not recognized</a><a class="headerlink" href="#solver-dependent-parameter-is-not-recognized" title="Permalink to this heading">¶</a></h3>
<p>The variable type should be specified to be recognized as a solver parameter.
For example, integer variable with name <em>num</em> is written as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">impurity_solver</span><span class="p">]</span>
<span class="n">num</span><span class="p">{</span><span class="nb">int</span><span class="p">}</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>
</div>
<p>The type can be int, str, and float.</p>
</section>
<section id="can-i-use-my-impurity-solver">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Can I use my impurity solver?</a><a class="headerlink" href="#can-i-use-my-impurity-solver" title="Permalink to this heading">¶</a></h3>
<p>Yes. Follow the instruction in <a class="reference internal" href="../impuritysolvers/how_to_integrate.html"><span class="doc">How to integrate your own solver</span></a></p>
</section>
</section>
<section id="others">
<h2><a class="toc-backref" href="#id18" role="doc-backlink">Others</a><a class="headerlink" href="#others" title="Permalink to this heading">¶</a></h2>
<section id="dcore-is-slow-even-with-mpi-parallelization">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">DCore is slow even with MPI parallelization</a><a class="headerlink" href="#dcore-is-slow-even-with-mpi-parallelization" title="Permalink to this heading">¶</a></h3>
<p>One of the reasons is that the number of threads of each MPI process is not set properly.
Unfortunately, the environment variable to set the number of threads is different among environments/libraries (OpenBLAS, Intel MKL, etc.).
The followings are the environment variables to set the number of threads for some libraries.</p>
<ul class="simple">
<li><p>OMP_NUM_THREADS</p></li>
<li><p>OPENBLAS_NUM_THREADS</p></li>
<li><p>MKL_NUM_THREADS</p></li>
<li><p>VECLIB_MAXIMUM_THREADS</p></li>
<li><p>NUMEXPR_NUM_THREADS</p></li>
</ul>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About DCore</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">Reference Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../support.html">Support</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">FAQ/Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="issues.html">Reporting issues</a></li>
</ul>
</li>
</ul>

  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../support.html"
                          title="previous chapter">Support</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="issues.html"
                          title="next chapter">Reporting issues</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="issues.html" title="Reporting issues"
             >next</a></li>
        <li class="right" >
          <a href="../support.html" title="Support"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">DCore  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../support.html" >Support</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">FAQ/Troubleshooting</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2017, The University of Tokyo.
    </div>
  </body>
</html>