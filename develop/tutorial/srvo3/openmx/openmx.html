
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Wanniernization using OpenMX &#8212; DCore  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/wild.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/dcore.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../../../index.html">DCore  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Wanniernization using OpenMX</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="wanniernization-using-openmx">
<h1>Wanniernization using OpenMX<a class="headerlink" href="#wanniernization-using-openmx" title="Permalink to this headline">¶</a></h1>
<p>OpenMX is a first-principles program package based on
the numerical localized basis set and pseudopotentials.
OpenMX itself can generate hopping parameter in the wannier90 format.
In this tutorial, we demonstrate the calculation of SrVO<sub>3</sub>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial requires large computational resources or long simulation time.</p>
</div>
<section id="scf-computation-and-wannier-with-openmx">
<h2>SCF computation and Wannier with OpenMX<a class="headerlink" href="#scf-computation-and-wannier-with-openmx" title="Permalink to this headline">¶</a></h2>
<p><a class="reference download internal" download="" href="../../../_downloads/c023139646f06e58203ae42058b13bf3/scf.dat"><code class="xref download docutils literal notranslate"><span class="pre">scf.dat</span></code></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># File Name</span>
<span class="c1">#</span>
<span class="n">System</span><span class="o">.</span><span class="n">CurrrentDirectory</span>         <span class="o">./</span>    <span class="c1"># default=./</span>
<span class="n">System</span><span class="o">.</span><span class="n">Name</span>                      <span class="n">SrVO3</span>
<span class="n">level</span><span class="o">.</span><span class="n">of</span><span class="o">.</span><span class="n">stdout</span>                   <span class="mi">1</span>    <span class="c1"># default=1 (1-3)</span>
<span class="n">level</span><span class="o">.</span><span class="n">of</span><span class="o">.</span><span class="n">fileout</span>                  <span class="mi">1</span>    <span class="c1"># default=1 (0-2)</span>
<span class="n">data</span><span class="o">.</span><span class="n">path</span>                 <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">kawamuura</span><span class="o">/</span><span class="n">program</span><span class="o">/</span><span class="n">openmx</span><span class="o">-</span><span class="n">eca</span><span class="o">/</span><span class="n">DFT_DATA13</span><span class="o">/</span>
<span class="c1">#</span>
<span class="c1"># Definition of Atomic Species</span>
<span class="c1">#</span>
<span class="n">Species</span><span class="o">.</span><span class="n">Number</span>       <span class="mi">4</span>
<span class="o">&lt;</span><span class="n">Definition</span><span class="o">.</span><span class="n">of</span><span class="o">.</span><span class="n">Atomic</span><span class="o">.</span><span class="n">Species</span>
  <span class="n">Sr</span>  <span class="n">Sr10</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">s2p2d1</span>  <span class="n">Sr_PBE13</span>
   <span class="n">V</span>  <span class="n">V6</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">s2p1d1</span>     <span class="n">V_PBE13</span>
   <span class="n">O</span>  <span class="n">O7</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">s2p2d1</span>     <span class="n">O_PBE13</span>
<span class="n">proj</span>  <span class="n">V6</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">s1p1d1</span>     <span class="n">V_PBE13</span>
<span class="n">Definition</span><span class="o">.</span><span class="n">of</span><span class="o">.</span><span class="n">Atomic</span><span class="o">.</span><span class="n">Species</span><span class="o">&gt;</span>
<span class="c1">#</span>
<span class="c1"># Atoms</span>
<span class="c1">#</span>
<span class="n">Atoms</span><span class="o">.</span><span class="n">Number</span>         <span class="mi">5</span>
<span class="n">Atoms</span><span class="o">.</span><span class="n">SpeciesAndCoordinates</span><span class="o">.</span><span class="n">Unit</span>   <span class="n">FRAC</span> <span class="c1"># Ang|AU</span>
<span class="o">&lt;</span><span class="n">Atoms</span><span class="o">.</span><span class="n">SpeciesAndCoordinates</span>
<span class="mi">1</span>  <span class="n">Sr</span>   <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">5.0</span>  <span class="mf">5.0</span>
<span class="mi">2</span>   <span class="n">V</span>   <span class="mf">0.5</span>  <span class="mf">0.5</span>  <span class="mf">0.5</span>  <span class="mf">6.5</span>  <span class="mf">6.5</span>
<span class="mi">3</span>   <span class="n">O</span>   <span class="mf">0.5</span>  <span class="mf">0.0</span>  <span class="mf">0.5</span>  <span class="mf">3.0</span>  <span class="mf">3.0</span>
<span class="mi">4</span>   <span class="n">O</span>   <span class="mf">0.0</span>  <span class="mf">0.5</span>  <span class="mf">0.5</span>  <span class="mf">3.0</span>  <span class="mf">3.0</span>
<span class="mi">5</span>   <span class="n">O</span>   <span class="mf">0.5</span>  <span class="mf">0.5</span>  <span class="mf">0.0</span>  <span class="mf">3.0</span>  <span class="mf">3.0</span>
<span class="n">Atoms</span><span class="o">.</span><span class="n">SpeciesAndCoordinates</span><span class="o">&gt;</span>
<span class="n">Atoms</span><span class="o">.</span><span class="n">UnitVectors</span><span class="o">.</span><span class="n">Unit</span>  <span class="n">AU</span>  <span class="c1"># Ang|AU</span>
<span class="o">&lt;</span><span class="n">Atoms</span><span class="o">.</span><span class="n">UnitVectors</span>
<span class="mf">7.29738</span>  <span class="mf">0.00000</span>  <span class="mf">0.00000</span>
<span class="mf">0.00000</span>  <span class="mf">7.29738</span>  <span class="mf">0.00000</span>
<span class="mf">0.00000</span>  <span class="mf">0.00000</span>  <span class="mf">7.29738</span>
<span class="n">Atoms</span><span class="o">.</span><span class="n">UnitVectors</span><span class="o">&gt;</span>
<span class="c1">#</span>
<span class="c1"># SCF or Electronic System</span>
<span class="c1">#</span>
<span class="n">scf</span><span class="o">.</span><span class="n">XcType</span>                 <span class="n">GGA</span><span class="o">-</span><span class="n">PBE</span>     <span class="c1"># LDA|LSDA-CA|LSDA-PW|GGA-PBE</span>
<span class="n">scf</span><span class="o">.</span><span class="n">SpinPolarization</span>        <span class="n">Off</span>         <span class="c1"># On|Off|NC</span>
<span class="n">scf</span><span class="o">.</span><span class="n">maxIter</span>                  <span class="mi">50</span>        <span class="c1"># default=40</span>
<span class="n">scf</span><span class="o">.</span><span class="n">EigenvalueSolver</span>       <span class="n">band</span>        <span class="c1"># DC|GDC|Cluster|Band</span>
<span class="n">scf</span><span class="o">.</span><span class="n">Kgrid</span>                  <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span>       <span class="c1"># means n1 x n2 x n3</span>
<span class="n">scf</span><span class="o">.</span><span class="n">Mixing</span><span class="o">.</span><span class="n">Type</span>           <span class="n">rmm</span><span class="o">-</span><span class="n">diisk</span>    <span class="c1"># Simple|Rmm-Diis|Gr-Pulay|Kerker|Rmm-Diisk</span>
<span class="n">scf</span><span class="o">.</span><span class="n">Init</span><span class="o">.</span><span class="n">Mixing</span><span class="o">.</span><span class="n">Weight</span>     <span class="mf">0.20</span>        <span class="c1"># default=0.30</span>
<span class="n">scf</span><span class="o">.</span><span class="n">Min</span><span class="o">.</span><span class="n">Mixing</span><span class="o">.</span><span class="n">Weight</span>      <span class="mf">0.001</span>       <span class="c1"># default=0.001</span>
<span class="n">scf</span><span class="o">.</span><span class="n">Max</span><span class="o">.</span><span class="n">Mixing</span><span class="o">.</span><span class="n">Weight</span>      <span class="mf">0.500</span>       <span class="c1"># default=0.40</span>
<span class="n">scf</span><span class="o">.</span><span class="n">Mixing</span><span class="o">.</span><span class="n">History</span>          <span class="mi">7</span>          <span class="c1"># default=5</span>
<span class="n">scf</span><span class="o">.</span><span class="n">Mixing</span><span class="o">.</span><span class="n">StartPulay</span>       <span class="mi">7</span>          <span class="c1"># default=6</span>
<span class="n">scf</span><span class="o">.</span><span class="n">Mixing</span><span class="o">.</span><span class="n">EveryPulay</span>       <span class="mi">1</span>          <span class="c1"># default=6</span>
<span class="n">scf</span><span class="o">.</span><span class="n">criterion</span>             <span class="mf">1.0e-7</span>       <span class="c1"># default=1.0e-6 (Hartree)</span>
<span class="n">orbitalOpt</span><span class="o">.</span><span class="n">Force</span><span class="o">.</span><span class="n">Skip</span>       <span class="n">on</span>
<span class="c1">#scf.restart                on</span>
<span class="c1">#</span>
<span class="c1"># Band dispersion</span>
<span class="c1">#</span>
<span class="n">Band</span><span class="o">.</span><span class="n">dispersion</span>              <span class="n">on</span>        <span class="c1"># on|off, default=off</span>
<span class="n">Band</span><span class="o">.</span><span class="n">Nkpath</span>  <span class="mi">4</span>
<span class="o">&lt;</span><span class="n">Band</span><span class="o">.</span><span class="n">kpath</span>
<span class="mi">15</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>    <span class="mf">0.5</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="n">g</span>  <span class="n">X</span>
<span class="mi">15</span>  <span class="mf">0.5</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>    <span class="mf">0.5</span>  <span class="mf">0.5</span>  <span class="mf">0.0</span>  <span class="n">X</span>  <span class="n">M</span>
<span class="mi">15</span>  <span class="mf">0.5</span>  <span class="mf">0.5</span>  <span class="mf">0.0</span>    <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="n">M</span>  <span class="n">g</span>
<span class="mi">15</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>    <span class="mf">0.5</span>  <span class="mf">0.5</span>  <span class="mf">0.5</span>  <span class="n">g</span>  <span class="n">R</span>
<span class="n">Band</span><span class="o">.</span><span class="n">kpath</span><span class="o">&gt;</span>
<span class="c1">#</span>
<span class="c1"># Wannier</span>
<span class="c1">#</span>
<span class="n">Wannier</span><span class="o">.</span><span class="n">Func</span><span class="o">.</span><span class="n">Calc</span> <span class="n">on</span> <span class="c1">#default off</span>
<span class="n">Wannier</span><span class="o">.</span><span class="n">Func</span><span class="o">.</span><span class="n">Num</span> <span class="mi">3</span> <span class="c1">#no default</span>
<span class="n">Wannier</span><span class="o">.</span><span class="n">Outer</span><span class="o">.</span><span class="n">Window</span><span class="o">.</span><span class="n">Bottom</span>  <span class="o">-</span><span class="mf">1.5</span>
<span class="n">Wannier</span><span class="o">.</span><span class="n">Outer</span><span class="o">.</span><span class="n">Window</span><span class="o">.</span><span class="n">Top</span>      <span class="mf">7.0</span>
<span class="n">Wannier</span><span class="o">.</span><span class="n">Inner</span><span class="o">.</span><span class="n">Window</span><span class="o">.</span><span class="n">Bottom</span>  <span class="o">-</span><span class="mf">1.5</span>
<span class="n">Wannier</span><span class="o">.</span><span class="n">Inner</span><span class="o">.</span><span class="n">Window</span><span class="o">.</span><span class="n">Top</span>      <span class="mf">1.2</span>
<span class="n">Wannier</span><span class="o">.</span><span class="n">Initial</span><span class="o">.</span><span class="n">Projectors</span><span class="o">.</span><span class="n">Unit</span> <span class="n">FRAC</span>
<span class="o">&lt;</span><span class="n">Wannier</span><span class="o">.</span><span class="n">Initial</span><span class="o">.</span><span class="n">Projectors</span>
<span class="n">proj</span><span class="o">-</span><span class="n">dxy</span> <span class="mf">0.5</span> <span class="mf">0.5</span> <span class="mf">0.5</span>  <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">1.0</span>  <span class="mf">1.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="n">proj</span><span class="o">-</span><span class="n">dxz</span> <span class="mf">0.5</span> <span class="mf">0.5</span> <span class="mf">0.5</span>  <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">1.0</span>  <span class="mf">1.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="n">proj</span><span class="o">-</span><span class="n">dyz</span> <span class="mf">0.5</span> <span class="mf">0.5</span> <span class="mf">0.5</span>  <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">1.0</span>  <span class="mf">1.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="n">Wannier</span><span class="o">.</span><span class="n">Initial</span><span class="o">.</span><span class="n">Projectors</span><span class="o">&gt;</span>
<span class="n">Wannier</span><span class="o">.</span><span class="n">Interpolated</span><span class="o">.</span><span class="n">Bands</span>             <span class="n">on</span>
<span class="n">Wannier</span><span class="o">.</span><span class="n">Function</span><span class="o">.</span><span class="n">Plot</span>                  <span class="n">on</span>         <span class="c1"># default off</span>
<span class="n">Wannier</span><span class="o">.</span><span class="n">Function</span><span class="o">.</span><span class="n">Plot</span><span class="o">.</span><span class="n">SuperCells</span>      <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>       <span class="c1"># default=0 0 0</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ openmx scf.dat
</pre></div>
</div>
<p>Then, convert the OpenMX output to the wannier90 format.
It can be performed with <code class="docutils literal notranslate"><span class="pre">openmx2dcore</span></code> utility as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ openmx2dcore.py SrVO3 srvo3
</pre></div>
</div>
</section>
<section id="dmft-calculation">
<h2>DMFT calculation<a class="headerlink" href="#dmft-calculation" title="Permalink to this headline">¶</a></h2>
<p><a class="reference download internal" download="" href="../../../_downloads/90e0825153f3d161a26ce497aa915e47/srvo3_openmx.ini"><code class="xref download docutils literal notranslate"><span class="pre">srvo3.ini</span></code></a></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[model]</span>
<span class="na">lattice</span> <span class="o">=</span> <span class="s">wannier90</span>
<span class="na">seedname</span> <span class="o">=</span> <span class="s">srvo3</span>
<span class="na">nelec</span> <span class="o">=</span> <span class="s">1.0</span>
<span class="na">ncor</span> <span class="o">=</span> <span class="s">1</span>
<span class="na">norb</span> <span class="o">=</span> <span class="s">3</span>
<span class="na">kanamori</span> <span class="o">=</span> <span class="s">[(3.419, 2.315, 0.530)]</span>
<span class="na">bvec</span><span class="o">=</span><span class="s">[(1.627091,0.0,0.0),(0.0,1.627091,0.0),(0.0,0.0,1.627091)]</span>

<span class="k">[system]</span>
<span class="na">nk0</span> <span class="o">=</span> <span class="s">16</span>
<span class="na">nk1</span> <span class="o">=</span> <span class="s">16</span>
<span class="na">nk2</span> <span class="o">=</span> <span class="s">16</span>
<span class="na">beta</span> <span class="o">=</span> <span class="s">40.0</span>
<span class="na">mu</span> <span class="o">=</span> <span class="s">0.0</span>
<span class="na">with_dc</span> <span class="o">=</span> <span class="s">True</span>
<span class="na">perform_tail_fit</span> <span class="o">=</span> <span class="s">True</span>
<span class="na">fit_max_moment</span> <span class="o">=</span> <span class="s">8</span>
<span class="na">fit_min_w</span> <span class="o">=</span> <span class="s">5.0</span>
<span class="na">fit_max_w</span> <span class="o">=</span> <span class="s">19.0</span>

<span class="k">[impurity_solver]</span>
<span class="na">name</span> <span class="o">=</span> <span class="s">TRIQS/cthyb</span>
<span class="na">n_cycles{int}</span> <span class="o">=</span> <span class="s">10000</span>
<span class="na">n_warmup_cycles{int}</span> <span class="o">=</span> <span class="s">10000</span>
<span class="na">length_cycle{int}</span> <span class="o">=</span> <span class="s">500</span>
<span class="na">move_double{bool}</span> <span class="o">=</span> <span class="s">True</span>

<span class="k">[control]</span>
<span class="na">max_step</span> <span class="o">=</span> <span class="s">8</span>

<span class="k">[tool]</span>
<span class="na">broadening</span> <span class="o">=</span> <span class="s">0.1</span>
<span class="na">nk_line</span> <span class="o">=</span> <span class="s">50</span>
<span class="na">nnode</span> <span class="o">=</span> <span class="s">5</span>
<span class="na">knode</span><span class="o">=</span><span class="s">[(G,0.0,0.0,0.0),(X,0.5,0.0,0.0),(M,0.5,0.5,0.0),(G,0.0,0.0,0.0),(R,0.5,0.5,0.5)]</span>
<span class="na">omega_max</span> <span class="o">=</span><span class="s">2.0</span>
<span class="na">omega_min</span> <span class="o">=</span><span class="s">-2.0</span>
<span class="na">Nomega</span> <span class="o">=</span> <span class="s">400</span>
<span class="na">omega_check</span> <span class="o">=</span> <span class="s">30.0</span>
<span class="na">omega_pade</span> <span class="o">=</span> <span class="s">5.0</span>
</pre></div>
</div>
<p>Please see <a class="reference internal" href="../../../impuritysolvers/triqs_cthyb/cthyb.html#howtocthyb"><span class="std std-ref">CT-QMC: TRIQS/cthyb</span></a> for the details of the parameter setting.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">n_cycles{int}</span></code> should be tuned in inverse proportion to the number of MPI processes.
The following result is obtained with 432 MPI processes at <code class="docutils literal notranslate"><span class="pre">n_cycles{int}</span> <span class="pre">=</span> <span class="pre">10000</span></code>
(70 seconds per DMFT cycle on ISSP system B).
If we want to compute by using 32 MPI processes at the same accuracy,
<code class="docutils literal notranslate"><span class="pre">n_cycles{int}</span></code> should be 10000*432/32=135000.</p>
</div>
<section id="dmft-setup-dcore-pre">
<h3>DMFT setup: dcore_pre<a class="headerlink" href="#dmft-setup-dcore-pre" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ dcore_pre srvo3.ini
</pre></div>
</div>
</section>
<section id="running-self-consistent-dmft-calculation-dcore">
<h3>Running self-consistent DMFT calculation: dcore<a class="headerlink" href="#running-self-consistent-dmft-calculation-dcore" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ dcore srvo3.ini
</pre></div>
</div>
</section>
<section id="post-processing-and-data-analysis-dcore-post">
<h3>Post-processing and data analysis: dcore_post<a class="headerlink" href="#post-processing-and-data-analysis-dcore-post" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ dcore_post srvo3.ini
$ sed -e <span class="s2">&quot;s/every 10/every 1/g&quot;</span> srvo3_akw.gp
$ gnuplot nis_akw.gp
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/akw_srvo31.png"><img alt="../../../_images/akw_srvo31.png" class="align-center" src="../../../_images/akw_srvo31.png" style="width: 500px;" /></a>
<p>“+” indicates the original band structure.</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../../../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../about.html">DCore</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference.html">Reference Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../support.html">Support</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="../../../index.html">DCore  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Wanniernization using OpenMX</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, The University of Tokyo.
    </div>
  </body>
</html>